find_package(Python3 COMPONENTS Development)
if(Python3_FOUND)
  MESSAGE("Python3_LIBRARY_DIRS: ${Python3_LIBRARY_DIRS}")
  add_library(eego_sdk3 MODULE
    ../eego_sdk.cc
  )
  set_target_properties(eego_sdk3 PROPERTIES OUTPUT_NAME eego_sdk)
  target_include_directories(eego_sdk3 SYSTEM PRIVATE ${Python3_INCLUDE_DIRS})
  target_include_directories(eego_sdk3 SYSTEM PRIVATE ${EEGO_SDK_ROOT})
  target_include_directories(eego_sdk3 SYSTEM PRIVATE ${PYTHON_INCLUDE_DIRS})
  target_include_directories(eego_sdk3 SYSTEM PRIVATE ${PYBIND11_INCLUDE_DIR})
  target_compile_definitions(eego_sdk3 PRIVATE EEGO_SDK_BIND_STATIC)
  target_compile_definitions(eego_sdk3 PRIVATE _UNICODE)
  target_Link_libraries(eego_sdk3 PRIVATE ${Python3_LIBRARIES})
  target_link_libraries(eego_sdk3 PRIVATE ${EEGO_SDK_LIBRARY})
  install(TARGETS eego_sdk3 DESTINATION share/eego-sdk-pybind11/python3)
  if(UNIX)
    set_target_properties(eego_sdk3 PROPERTIES PREFIX "")

    get_filename_component(EEGO_SDK_LIBRARY_DIR ${EEGO_SDK_LIBRARY} DIRECTORY)
    install(FILES ${EEGO_SDK_LIBRARY_DIR}/libeego-SDK.so DESTINATION share/eego-sdk-pybind11/python3)
  endif()
  if(WIN32)
    set_target_properties(eego_sdk3 PROPERTIES SUFFIX .pyd)

    get_filename_component(EEGO_SDK_LIBRARY_DIR ${EEGO_SDK_LIBRARY} DIRECTORY)
    install(FILES ${EEGO_SDK_LIBRARY_DIR}/eego-SDK.dll DESTINATION share/eego-sdk-pybind11/python3)
  endif()
endif()
